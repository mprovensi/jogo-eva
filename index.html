<!DOCTYPE html>
<html lang="pt">
<head>
	<meta charset="UTF-8">
	<title>Jogo do Pulo</title>
	<style>
		html, body { height: 100%; margin: 0; padding: 0; overflow: hidden; }
		body { width: 100vw; height: 100vh; }
		#gameCanvas {
			position: absolute;
			top: 0; left: 0;
			width: 100vw;
			height: 100vh;
			background: #cceeff;
			display: block;
		}
		#restartBtn {
			position: absolute;
			top: 20px;
			right: 20px;
			z-index: 10;
			padding: 10px 20px;
			font-size: 18px;
			background: #2ecc40;
			color: #fff;
			border: none;
			border-radius: 5px;
			cursor: pointer;
			box-shadow: 0 2px 6px rgba(0,0,0,0.2);
		}
	</style>
</head>
<body>
	<button id="restartBtn" style="position: absolute; top: 16px; right: 16px; padding: 10px 22px; min-width: 60px; min-height: 32px; font-size: 18px; background: #2ecc40; color: #fff; border: none; border-radius: 5px; cursor: pointer; box-shadow: 0 2px 6px rgba(0,0,0,0.2); z-index: 10; touch-action: manipulation;">Reiniciar</button>
	<button id="jumpBtn" style="position: absolute; bottom: 6vw; right: 6vw; width: 16vw; height: 16vw; min-width: 70px; min-height: 70px; max-width: 120px; max-height: 120px; border-radius: 50%; background: #2ecc40; border: none; box-shadow: 0 2px 6px rgba(0,0,0,0.2); display: flex; align-items: center; justify-content: center; z-index: 20; cursor: pointer; touch-action: manipulation;">
		<svg width="40" height="40" viewBox="0 0 40 40">
			<polygon points="20,8 32,28 8,28" fill="#fff" />
		</svg>
	</button>
	<canvas id="gameCanvas"></canvas>
	<script>
	let jumpScore = 0;
		const canvas = document.getElementById('gameCanvas');
		const ctx = canvas.getContext('2d');

		function resizeCanvas() {
			canvas.width = window.innerWidth;
			canvas.height = window.innerHeight;
		}
		resizeCanvas();
		window.addEventListener('resize', resizeCanvas);

		// Personagem
		const player = {
			x: 80,
			y: 0, // será ajustado após groundY
			width: 70,
			height: 120,
			color: '#2ecc40', // roupa verde
			hair: '#8B4513', // cabelo marrom
			speed: 6,
			vy: 0,
			jumping: false
		};
		let groundY = canvas.height - 100;
	const offsetY = 12;
	player.y = groundY + 30 - player.height + offsetY;

		// Obstáculos
		let obstacles = [];
		let obstacleTimer = 0;

		// Imagem da cabeça
	// Imagem do dinossauro
	const dinoImg = new Image();
	dinoImg.src = 'dinossauro.png';

		function drawPlayer() {
			// Desenha o dinossauro
			if (dinoImg.complete) {
				ctx.drawImage(dinoImg, player.x, player.y, player.width, player.height);
			} else {
				dinoImg.onload = function() {
					ctx.drawImage(dinoImg, player.x, player.y, player.width, player.height);
				};
			}
		}

		function drawObstacle(obs) {
			ctx.fillStyle = '#555';
			ctx.fillRect(obs.x, obs.y, obs.width, obs.height);
			ctx.strokeStyle = '#222';
			ctx.strokeRect(obs.x, obs.y, obs.width, obs.height);
		}

		function clearCanvas() {
			// Fundo pôr do sol
			const grad = ctx.createLinearGradient(0, 0, 0, canvas.height);
			grad.addColorStop(0, '#ffb347'); // laranja claro
			grad.addColorStop(0.5, '#ffcc80'); // amarelo
			grad.addColorStop(1, '#6b4f1d'); // marrom escuro
			ctx.fillStyle = grad;
			ctx.fillRect(0, 0, canvas.width, canvas.height);

			// Sol estático
			const sunX = canvas.width / 2;
			const sunY = canvas.height / 2 - 160;
			// Sol
			ctx.beginPath();
			ctx.arc(sunX, sunY, 60, 0, Math.PI * 2);
			ctx.fillStyle = '#fff700';
			ctx.globalAlpha = 0.85;
			ctx.fill();
			ctx.globalAlpha = 1;

			// Nuvens na frente do sol
			function drawCloud(cx, cy, scale = 1) {
				ctx.save();
				ctx.globalAlpha = 0.8;
				ctx.fillStyle = '#fff';
				ctx.beginPath();
				ctx.arc(cx, cy, 28 * scale, Math.PI * 0.7, Math.PI * 2.3);
				ctx.arc(cx + 22 * scale, cy, 22 * scale, Math.PI * 0.5, Math.PI * 2.5);
				ctx.arc(cx + 40 * scale, cy + 8 * scale, 16 * scale, Math.PI * 0.5, Math.PI * 2.5);
				ctx.arc(cx + 16 * scale, cy + 16 * scale, 18 * scale, Math.PI * 0.5, Math.PI * 2.5);
				ctx.closePath();
				ctx.fill();
				ctx.restore();
			}
			// Mais nuvens na frente do sol
			drawCloud(sunX + 120, sunY + 80, 1.1);
			drawCloud(sunX - 60, sunY + 60, 1.2);
			drawCloud(sunX - 40, sunY + 60, 0.8);
			drawCloud(sunX - 10, sunY + 30, 0.7);
			drawCloud(sunX - 100, sunY +40, 1.2);
			drawCloud(sunX + 50, sunY - 8, 0.8);
			drawCloud(sunX + 100, sunY + 40, 0.7);
			drawCloud(sunX + 35, sunY + 28, 0.6);
			drawCloud(sunX - 25, sunY + 18, 0.8);

			// Floresta (árvores simples)
			// Árvores paralaxe variadas e densas
			const treeCount = 15;
			if (!window.trees) {
				window.trees = [];
				for (let i = 0; i < treeCount; i++) {
					const size = 24 + Math.random() * 92;
					const trunkHeight = size * 1.2;
					window.trees.push({
						x: Math.random() * canvas.width,
						y: groundY - 90,
						size,
						trunkHeight
					});
				}
			}
			// Ordena as árvores por tamanho (menores atrás, maiores à frente)
			window.trees.sort((a, b) => a.size - b.size);
			for (let tree of window.trees) {
				tree.x -= 1.2;
				if (tree.x < -tree.size) tree.x = canvas.width + tree.size;
				// Tronco
				ctx.fillStyle = '#6b4f1d';
				ctx.fillRect(tree.x, tree.y, tree.size * 0.5, tree.trunkHeight);
				// Copa
				ctx.beginPath();
				ctx.arc(tree.x + tree.size * 0.25, tree.y, tree.size, 0, Math.PI * 2);
				ctx.fillStyle = '#228B22';
				ctx.fill();
				// Borda fina verde escura
				ctx.lineWidth = 1;
				ctx.strokeStyle = '#145214';
				ctx.stroke();
			}

			// Desenha o chão
			ctx.fillStyle = '#888';
			ctx.fillRect(0, groundY + 30, canvas.width, 30);
		}

		function updatePlayer() {
			// Incrementa o contador se o personagem está pulando e passa por um obstáculo
			for (let obs of obstacles) {
				if (!obs.scored && player.x > obs.x + obs.width) {
					obs.scored = true;
					if (player.jumping) jumpScore++;
				}
			}
			// Exibe o contador de acertos de pulo
			ctx.font = 'bold 32px Arial';
			ctx.fillStyle = '#222';
			ctx.textAlign = 'left';
			ctx.fillText('PONTOS: ' + jumpScore, 24, 48);
			groundY = canvas.height - 100;
			// Gravidade e pulo
			if (player.y + player.height < groundY + 30 || player.jumping) {
				player.vy += 0.9;
				player.y += player.vy;
				if (player.y + player.height >= groundY + 30) {
					player.y = groundY + 30 - player.height + offsetY;
					player.vy = 0;
					player.jumping = false;
				}
			}
		}

		function updateObstacles() {
			for (let obs of obstacles) {
				obs.x -= 6;
			}
			obstacles = obstacles.filter(obs => obs.x + obs.width > 0);
			// Gera novo obstáculo
			obstacleTimer--;
			if (obstacleTimer <= 0) {
				// Altura máxima do pulo: v^2 / (2 * g)
				const jumpVelocity = Math.abs(-25);
				const gravity = 0.9;
				const maxJumpHeight = Math.floor((jumpVelocity * jumpVelocity) / (2 * gravity));
				const minHeight = 30;
				const maxHeight = Math.floor(maxJumpHeight * 0.5); // altura máxima dos obstáculos reduzida
				const obsHeight = minHeight + Math.floor(Math.random() * (maxHeight - minHeight + 1));
				obstacles.push({
					x: canvas.width,
					y: groundY + 30 - obsHeight,
					width: 30,
					height: obsHeight
				});
				obstacleTimer = 80 + Math.floor(Math.random() * 60);
			}
		}

		function checkCollision() {
			for (let obs of obstacles) {
				if (
					player.x < obs.x + obs.width &&
					player.x + player.width > obs.x &&
					player.y + player.height > obs.y &&
					player.y < obs.y + obs.height
				) {
					// Colidiu
					ctx.font = 'bold 70px Arial';
					ctx.fillStyle = '#b74747';
					ctx.textAlign = 'center';
					ctx.fillText('Game Over!', canvas.width / 2, canvas.height / 2);
					jumpScore = 0;
					return true;
				}
			}
			return false;
		}

		let gameOver = false;
		function gameLoop() {
			clearCanvas();
			updatePlayer();
			updateObstacles();
			drawPlayer();
			for (let obs of obstacles) drawObstacle(obs);
			if (!checkCollision() && !gameOver) {
				requestAnimationFrame(gameLoop);
			} else {
				gameOver = true;
			}
		}

		function restartGame() {
			// Resetar variáveis do jogo
			player.x = 80;
			groundY = canvas.height - 100;
			player.y = groundY + 30 - player.height + offsetY;
			player.vy = 0;
			player.jumping = false;
			obstacles = [];
			obstacleTimer = 0;
			gameOver = false;
			clearCanvas();
			gameLoop();
		}

		document.getElementById('restartBtn').addEventListener('click', restartGame);

		document.addEventListener('keydown', function(e) {
			if (e.key === 'ArrowRight') {
				player.x += player.speed;
				if (player.x + player.width > canvas.width) player.x = canvas.width - player.width;
			}
			if (e.key === 'ArrowLeft') {
				player.x -= player.speed;
				if (player.x < 0) player.x = 0;
			}
			if ((e.key === ' ' || e.key === 'ArrowUp') && !player.jumping && player.y + player.height >= groundY + 30) {
				player.vy = -25;
				player.jumping = true;
			}
		});

		// Permite pular ao clicar no botão
		function jumpAction() {
			if (!player.jumping && player.y + player.height >= groundY + 30) {
				player.vy = -25;
				player.jumping = true;
			}
		}
		const jumpBtn = document.getElementById('jumpBtn');
		jumpBtn.addEventListener('click', jumpAction);
		jumpBtn.addEventListener('touchstart', function(e) {
			e.preventDefault();
			jumpAction();
		}, {passive: false});

		gameLoop();
	</script>
</body>
</html>